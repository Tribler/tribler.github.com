<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>Tribler</title>

<link rel="stylesheet" href="/css/style.css" />
<link rel="stylesheet" href="/css/trac.css" type="text/css" />
<link rel="shortcut icon" href="/img/favicon.ico" type="image/x-icon" />
<link rel="icon" href="/img/favicon.ico" type="image/x-icon" />

<!--[if lt IE 9]>
<script src="/js/html5shiv.js"></script>
<![endif]-->

<script type="text/javascript" src="/js/jquery-1.10.2.min.js"></script>
<script type="text/javascript">
      var uservoiceOptions = {
        /* required */
        key: 'tribler',
        host: 'tribler.uservoice.com',
        forum: '90409',
        showTab: true,
        /* optional */
        alignment: 'right',
        background_color:'#f00',
        text_color: 'white',
        hover_color: '#009ec3',
        lang: 'en'
      };

      function _loadUserVoice() {
        var s = document.createElement('script');
        s.setAttribute('type', 'text/javascript');
        s.setAttribute('src', ("https:" == document.location.protocol ? "https://" : "http://") + "cdn.uservoice.com/javascripts/widgets/tab.js");
        document.getElementsByTagName('head')[0].appendChild(s);
      }
      _loadSuper = window.onload;
      window.onload = (typeof window.onload != 'function') ? _loadUserVoice : function() { _loadSuper(); _loadUserVoice(); };
    </script>

	<script type="text/javascript" src="/js/jquery-1.10.2.min.js"></script>
</head>

<body>

<div id="wrap">
	<header>
		<a href="/index.html"><img src="/img/tribler-logo.png" alt="Return to the homepage" /></a>
		
		<nav>
			<ul>
				<li><a href="#">Tribler</a>
				    <ul>
				        <li><a href="/about.html">About Tribler</a></li>
				        <li><a href="http://statistics.tribler.org">Statistics</a></li>
				    </ul>
				</li>
				<li><a href="/download.html">Download</a></li>
				<li><a href="#">Users</a>
				    <ul>
				        <li><a href="/howto.html">How does it work</a></li>
				        <li><a href="/faq.html">FAQ</a></li>
				    </ul>
				</li>
				<li><a href="#">Developers</a>
				    <ul>
					<li><a href="https://github.com/Tribler/tribler">Github</a></li>
					<li><a href="https://github.com/Tribler/tribler/wiki">Wiki</a></li>
					<li><a href="/TitleIndex">Archive</a></li>
				    </ul>
				</li>
				<li><a href="http://forum.tribler.org">Forum</a></li>
			</ul>
		</nav>
	</header>	
	
	<section id="trac"><table><tr><td><h1 id="Swarm-basedReputationConsensus">Swarm-based Reputation Consensus</h1>
<p>
In a nutshell: a mechanism for improving bartercast with swarm-based information diffusion. Trusted peers start torrents to disseminate their current view of the system and other peers join such torrents to update their views.
[Rahim: How a peer knows that it is trusted by others?]
</p>
<p>
<em>[Todo: the discussion on the feasibility of keeping track of behavior for one million peers is relevant but somehow orthogonal to how information is propagated. Where should we put it then?]</em> 
</p>
<h2 id="RelationshipwithBarterCast">Relationship with <a class="wiki" href="/BarterCast">BarterCast</a></h2>
<p>
<a class="wiki" href="/BarterCast">BarterCast</a> is a reputation mechanism based on a contribution network built by each peer with information it gathers from the system. Peers propagate information about other peers' behavior through gossiping and use this information to build a directed graph of contributions. This graph then serves as input for a ranking algorithm such as Maxflow (of contributions to the peer calculating the reputations) or PageRank. 
</p>
<p>
An issue with this mechanism, however, is that information might take a considerable amount of time to propagate and therefore the opinion of the community about a peer might diverge for long periods. 
[Johan: more importantly it facilitates a secure and fast bootstrap. The reputation system at a newly installed peer is fully operational after just downloading a single file]
</p>
<p>
If information could be passed around in the form of signed certificates of contribution, it could be more trustable. However, this would cause potentially large convergence times. This can be circumvented if some peers merge this information and are trusted to propagate the result of such merging. 
<em>[Todo: I was unsure whether transaction certificates are sent around in BarterCast.]</em>
</p>
<h2 id="Synchronizingviewswithtrustedtorrents">Synchronizing views with trusted torrents</h2>
<p>
Consider a network for which the reputation network has converged in all peers. The central idea of swarm-based reputation consensus is that the centroids of the reputation graph can periodically (once every few days maybe) initiate torrents to propagate the contribution network they currently have. After a (small) number of these peers perform this operation, other peers join the torrents and update their current reputation network by merging their view of the system with that of the trusted peer that initiated the torrent. 
<br /> [Rahim: I think that reputation graph based on upload contribution is not appropriate to make a snapshot of others upload treatment. Look at example below: In this reputation graph, node 5 has uploaded to nodes 3 and 7 and according to definition of the graph center it is the center of the graph. But based on this info what it can do for others?] <a class="wiki" href="http://www.tribler.org/trac/raw-attachment/wiki/SwarmBasedReputationConsensus/Picture 1.png"></a> <br />
If instead of reputation graph, nodes use another metric to decide whether to make a snapshot of reputation graph or not, it will be better. We can name it awareness graph and each node that knows more makes snapshot and creates relevant swarm. For example, suppose figure below:<br />
<a class="wiki" href="http://www.tribler.org/trac/raw-attachment/wiki/SwarmBasedReputationConsensus/Picture 2.png"></a><br />
In this figure blue nodes and edges between them show the local reputation graph of the associated red node. If the reputation graph be converged all nodes will have same view point. In this figure nodes 6 and 2 more less than node 9. Node 9 knows about 7 upload actions ( number of edges) but the others know about 5 uploads. So if node 9 make a snapshot and propagate it, it will be better and brings more info to others. <br />
But there is two important questions: in a distributed environment how a node should know that  it knows more than others and it's knowledge  is fresher? ]
</p>
<p>
 
</p>
<p>
If the convergence about the contribution network is not perfect, some peers will not identify correctly who are the trusted publishers of the contribution network. These peers can use the popularity of current swarms distributing contribution networks to estimate which are the most trusted ones. <em>[Todo: This assumes trusted swarm size information.]
</em>
The rationale for this approach is that if peers synchronize often with the same highly-trusted peers, information will be more rapidly disseminated than through gossiping alone.
</p>
<p>
<em>[Todo: if we know who are the most trusted peers, maybe it is also a good idea to prioritize them when gossiping new info.]
</em>
</p>
<h2 id="Openissues:">Open issues:</h2>
<ul><li>Do we have hard evidence that gossiping alone is not already enough for disseminating contribution information?
</li></ul><ul><li>Reputation in mechanism could be more general than <a class="wiki" href="/BarterCast">BarterCast</a> data only, including friendship certificates and other data. How to aggregate such different sources?
</li></ul><ul><li>If we know that only trusted peers will merge the information, do we need to keep gossiping to everyone about everyone else's behavior?
</li></ul><ul><li>If different sets of peers start trusting different peers that have different views of the network, can they disagree progressively more over time instead of moving towards consensus?
</li></ul><ul><li>Can we make the system so that it encourages non-tribler peers to follow the protocol?
</li></ul><h2 id="AnalysisofBarterCast">Analysis of <a class="wiki" href="/BarterCast">BarterCast</a></h2>
<p>
To reply some of the above questions, whether gossiping is enough for spreading info or are there strong peers that their local history is rich enough, we decided to evaluate current running <a class="wiki" href="/BarterCast">BarterCast</a> and measure some parameters. Below are some of them and their description:
</p>
<ul><li><em>Number of replicas in different cycles</em>: This parameter shows the number of peers that have a specified report/s in their local history in different cycles/time of running. To measure this parameter we should check existence of those specified records and count how many peers have them in their cache. It can be shown in a graph, x-axis shows the relative cycle/time and y-axis shows the number of peers that have that records.
</li></ul><p>
 
</p>
<ul><li><em>Coverage rate</em>: The number of peers that have a specified record/records divide by the total number of peers. This shows the convergence speed toward same view.  Again in a graph x-axis can show the time and y-axis the coverage percent.
</li></ul><ul><li><em>Convergency</em>: During discrete time intervals of running or simulation we can measure the convergence of the peers toward same view. The local history shows the view of peer. If H be the union of the all local histories and f(h) be a  function that maps local history to a real value, then the convergence of arbitrary peer P can be f(P)/f(H). A distribution of the convergence make clear the effectiveness of the gossiping.
</li></ul><ul><li><em>Determining the number of power nodes</em>:  As a simple definition, power nodes are the nodes that know more and their local history have converged enough. Also this definition is vague but we can clear it later. For example by using power low distribution,  if local history of a node covers over 80 % of the total history ,  f(P)/f(H)  &gt; 0.8,  it is counted as a power node. The number can be shown as a graph where x-axis and y-axis shows the time and number of power nodes respectively. We can also determine when the first power node comes out. 
</li></ul><p>
   
</p>
<h2 id="Howtomeasure">How to measure</h2>
<p>
Requirements: 
</p>
<ul><li>Many nodes should run the code. How many is enough?
</li><li>In each cycle the local history of the nodes should be logged. To save space only changes can be logged.
</li><li>Nodes should be active and act as what happens in real case. 
</li><li>Churn should be considered.
</li></ul><p>
The BIG question is how? Simulation or actual experiment? <br />
</p>
<h2 id="Usingcrawler">Using crawler</h2>
<p>
By using modified peers we can crawl inside the local history of the nodes and impose them to log and send their local history's changes. By following the log of changes we can trace the change of local history from beginning to end. Below are the tasks that should be done:
</p>
<ol><li><em>Finalizing the list of parameters to be measured</em> . <strong>DONE</strong>
</li><li><em>Details of how the above parameters should be measured</em>. <strong>DONE</strong>
</li><li><em>Implementing crawler and data gatherer</em>. <strong>DONE</strong>
</li><li><em>Implementing data analysis tool</em>. <strong>DONE</strong>
</li><li><em>Actual running and data gathering</em>. <strong>DONE</strong>
</li><li><em>Data Analysis and publishing the result</em>. <strong>TODO</strong>
</li></ol><h2 id="Bartercastgraphvisualization">Bartercast graph visualization</h2>
<p>
To have a proper imagination of the layout and connectivity of the bartercast graph,  the collected bartercast records have been visualized in one graph. By using [Graphviz] and [ZGRViewer] tools a directed graph is drawn that shows data transfer between Tribler nodes. We started colleting of data on 20-June and the drawn graph is for 6'th of August. During this period each online node is contacted every hour and asked for new bartercast records. In the below graph:
</p>
<ul><li>If (A, B , Downloaded, Uploaded) be a bartercast record, if "Downloaded" be greater than zero then arc B--&gt;A is added to the graph.<br /> If Uploaded be greater than zero then arc A--&gt;B is added too.
</li><li>For each pair of nodes that have data transfer with each other, the most recent record is selected for drawing arc and calculating the sum of transfered data<br />. 
</li><li>Nodes are ranked by their interaction with other nodes. Before drawing they are ranked by their indegree+outdegree and that value <br /> determines their rank and color. To do ranking, first maximum of indegree plus outdegree is founded. Then the interval [0, maximum_degree]  is divided into 5 interval. The index of each interval shows the rank of the node.<br /> For example, for a graph with maximum degree 65, if a node's indegree+outdegree be 24 then It's rank is ceil(24/(65/5))= 2.
</li><li>Ranks: Red=5 , Blue=4, Green=3 ,Golden=2, olivergreen=1 and pink=no connection 
</li></ul><h3 id="Bartercastgraphforthefirst20000recordsmax_degree65">Bartercast graph (for the first 20000 records), max_degree=65 ===  </h3>
<p>
<a class="wiki" href="http://www.tribler.org/trac/raw-attachment/wiki/SwarmBasedReputationConsensus/bcast_all_node_0806_2.png"><img src="http://www.tribler.org/trac/raw-attachment/wiki/SwarmBasedReputationConsensus/bcast_all_node_0806_2.png"></a>
<br />
</p>
<h3 id="Bartercastgraphzoomedinforthefirst20000records">Bartercast graph zoomed in (for the first 20000 records) ===  </h3>
<p>
<a class="wiki" href="http://www.tribler.org/trac/raw-attachment/wiki/SwarmBasedReputationConsensus/bcast_all_node_zoom_0806.png"><img src="http://www.tribler.org/trac/raw-attachment/wiki/SwarmBasedReputationConsensus/bcast_all_node_zoom_0806.png"></a>
<br /> <br />
</p>
<h3 id="Bartercastgraphallrecordstill2009-08-06max_degree189">Bartercast graph all records till 2009-08-06 , max_degree=189 ===  </h3>
<p>
<em>Note:</em> A higher resolution picture also is attached but showing it on the wiki messes the text. You can download and look at it by other tools.<br />
<a class="wiki" href="http://www.tribler.org/trac/raw-attachment/wiki/SwarmBasedReputationConsensus/bcast_with_all_record_till_0806_less_resolution.png"><img src="http://www.tribler.org/trac/raw-attachment/wiki/SwarmBasedReputationConsensus/bcast_with_all_record_till_0806_less_resolution.png"></a>
<br /> The "graphviz" files also are attached, "databasecrawler_090806_1_bartercast_graph.gv" for limited first 20000 records, and "bartercast_graph_all_records_till_0806.gv" for all records. You can use ZGRViewer to see different fomrs of zooming (bird eye, block,...) and see nodes connectivity details. 
<br /> 
</p>
<h2 id="InitialResults">Initial Results</h2>
<p>
After collecting data for almost a one and half month ( from 20 June till Aug. 6) and processing them we obtained following results. 
During this period the crawler contacted 2017 nodes. Some of them didn't reply at all but from almost 1800 nodes replied at least once. Some peers were very active and crawler
was able to collect their full local history but most of them just come and leave.  The cycle or interval length is et to 4 hours and the period of asking peers is one hour. Below is the analysis result 
for the mentioned set of data. 
</p>
<h3 id="Averageofreplicas">Average of replicas ===  </h3>
<p>
Average number of replicas in different cycles. Records come in the system in different time, so the first cycle for a records may be different cycle for other records. 
To resolve this issue, we shift all of the records to the start cycle and measure the average number of records relatively. The same processing is done for number of peers in 
different cycles. In the way calculations for last periods are less accurate(because less peers and records enter into system in the initial time) but it is acceptable. Figure below shows this 
</p>
<blockquote>
<p>
<br />
</p>
</blockquote>
<p>
<a class="wiki" href="http://www.tribler.org/trac/raw-attachment/wiki/SwarmBasedReputationConsensus/average_of_replicase_0806.png"><img src="http://www.tribler.org/trac/raw-attachment/wiki/SwarmBasedReputationConsensus/average_of_replicase_0806.png"></a>
</p>
<p>
Below graph just shows average number of replicas<br />
<a class="wiki" href="http://www.tribler.org/trac/raw-attachment/wiki/SwarmBasedReputationConsensus/average_of_replicase_just_replicas_0806.png"><img src="http://www.tribler.org/trac/raw-attachment/wiki/SwarmBasedReputationConsensus/average_of_replicase_just_replicas_0806.png"></a>
</p>
<h3 id="Coverage">Coverage ===  </h3>
<p>
By definition coverage means, the rate of the peers that have a records in their cache. Figure below shows the average of coverage for different records in different cycles <br />
<a class="wiki" href="http://www.tribler.org/trac/raw-attachment/wiki/SwarmBasedReputationConsensus/coverage_average_0806.png"><img src="http://www.tribler.org/trac/raw-attachment/wiki/SwarmBasedReputationConsensus/coverage_average_0806.png"></a>
</p>
<h3 id="Convergence">Convergence ===  </h3>
<p>
By Convergence we mean the how local history of a node can represent local union of local history of all nodes in the system. By formula, in a specified cycle the number of records in local history divided by  the number of records in all local histories of all nodes. We did measuring convergence at the period and categorized local histories in five groups:
</p>
<ul><li>Very good: Nodes in this category cover more than 80% of all records in the system.
</li><li>Good:  Nodes cover [60%, 80%) of  all records.
</li><li>Middle: Nodes cover [40%, 60%) of all records.
</li><li>Bad: Nodes cover [20%, 40%) of all records.
</li><li>Very bad: Nodes cover less than 20% of the records in the system.
</li></ul><p>
figure and table below shows the obtained result  <br />
<a class="wiki" href="http://www.tribler.org/trac/raw-attachment/wiki/SwarmBasedReputationConsensus/convergence_0806.png"><img src="http://www.tribler.org/trac/raw-attachment/wiki/SwarmBasedReputationConsensus/convergence_0806.png"></a>
</p>
<h3 id="Peerscacherichnessaccuracyandonliness">Peers cache richness, accuracy and onliness</h3>
<p>
The system is a dynamic system and peers join and leave. To differentiate peers from each other we used to fuzzy parameter: richness and accuracy. As the name indicates, the richness means how many records is available in a peer's cache and accuracy gives and indication of synchronization between peer's cache and collected info about peer's cache by crawler. If crawler can not connect to
node for long time the accuracy level of that node will decrease. The richness and accuracy of the peers have been categorized into five different groups <br />
To categorize the richness the interval of [0,size_of_largest_cache] is logarithmically divided into five intervals. The richest nodes are those that their cache size is larger than half of the max cache size.
The below fuzzy terms have been used to categorize richness peers richness level:<br />
</p>
<ul><li>Very good:  cache_size &gt;= max_cache_size / 2 .
</li><li>Good:   max_cache_size / 4 &lt;= cache_size &lt;  max_cache_size / 2 .
</li><li>Middle: max_cache_size / 8 &lt;= cache_size &lt;  max_cache_size / 4
</li><li>Bad:  max_cache_size / 16 &lt;= cache_size &lt;  max_cache_size / 8 .
</li><li>Very bad: cache_size &lt; max_cache_size / 16
</li></ul><p>
Figure and table below shows the obtained result<br />
<a class="wiki" href="http://www.tribler.org/trac/raw-attachment/wiki/SwarmBasedReputationConsensus/richness_level_0806.png"><img src="http://www.tribler.org/trac/raw-attachment/wiki/SwarmBasedReputationConsensus/richness_level_0806.png"></a> 
</p>
<p>
It is possible that some peers be rich in cache but they don't reply to the crawaler for long time. An other metric that is used to measure this phenomena is accuracy. Accurate peers are those that reply to the crawler just very close, in time, to the end of measurement. For exampe, if the last collected record is in the system be logged at time T then those peers that have replied to the crawler after 
T -threshold_level are very accurate. List below shows different accuracy levels and their meaning:
</p>
<ul><li>Very good:  peer_last_reply_time &gt; T - threshold 
</li><li>Good:   T-threshold &lt; peer_last_reply_time &lt; 2 x ( T - threshold ) .
</li><li>Middle:  2 x (T-threshold) &lt; peer_last_reply_time &lt; 3 x ( T - threshold ) .
</li><li>Bad:  3 x (T-threshold) &lt; peer_last_reply_time &lt; 4 x ( T - threshold ) .
</li><li>Very bad: 4 x (T-threshold) &lt; peer_last_reply_time
</li></ul><p>
For calculation, the threshold is set to eight hours and a slack of four hours also deducted from last reply time to leverage the values around the middle. Figure below shows the result:<br />
<a class="wiki" href="http://www.tribler.org/trac/raw-attachment/wiki/SwarmBasedReputationConsensus/cache_accuracy_0806.png"><img src="http://www.tribler.org/trac/raw-attachment/wiki/SwarmBasedReputationConsensus/cache_accuracy_0806.png"></a>
</p>
<p>
Another parameter about peers that worth to measure is their onliness, or the rate of their online time to the time passed since their discovery by crawler. Because of the way that crawler contacts with peers, their online time is not accurate but in approximation it is very close to accurate value. Again we used fuzzy value to categorize onliness:
</p>
<ul><li>Very good:  onliness &gt;= 0.8 .
</li><li>Good:   0.6&lt;= onliness &lt; 0.8 .
</li><li>Middle:  0.4 &lt;= onliness &lt; 0.6 .
</li><li>Bad:  0.2 &lt;= onliness &lt; 0.4 .
</li><li>Very bad: onliness &lt; 0.2 .
</li></ul><p>
Graph below shows the result:<br />
<a class="wiki" href="http://www.tribler.org/trac/raw-attachment/wiki/SwarmBasedReputationConsensus/onliness_0806.png"><img src="http://www.tribler.org/trac/raw-attachment/wiki/SwarmBasedReputationConsensus/onliness_0806.png"></a>
  
</p>
<h3 id="Correlationbetweenparameters">Correlation between parameters</h3>
<p>
The accuracy, richness and onliness are in some way correlated. Peers that stay online for long time collect many records, so there should be positive correlation between onliness and richness. Also peers with less accuracy will have less richness and onliness. The following graphs show correlations between different parameters.<br />
For each node, the value of accuracy minus onliness determines correlation. The value for correlation is divided into five categories:
</p>
<ul><li>High correlation:  | accuracy - onliness | = 0
</li><li>Correlated :  | accuracy - onliness | = 1
</li><li>Middle correlation :  | accuracy - onliness | = 2
</li><li>Weakly correlation:  | accuracy - onliness | = 3
</li><li>No correlation:  | accuracy - onliness | = 4
</li></ul><p>
same story is applied for other correlations shown below.
</p>
<p>
Correlation between accuracy and onliness<br />
<a class="wiki" href="http://www.tribler.org/trac/raw-attachment/wiki/SwarmBasedReputationConsensus/peers_accuracy_online_correlation_0806.png"><img src="http://www.tribler.org/trac/raw-attachment/wiki/SwarmBasedReputationConsensus/peers_accuracy_online_correlation_0806.png"></a>
</p>
<p>
Correlation between richness and accuracy<br />
<a class="wiki" href="http://www.tribler.org/trac/raw-attachment/wiki/SwarmBasedReputationConsensus/peers_accuracy_richness_correlation_0806.png"><img src="http://www.tribler.org/trac/raw-attachment/wiki/SwarmBasedReputationConsensus/peers_accuracy_richness_correlation_0806.png"></a>
</p>
<p>
Correlation between richness and onliness<br />
<a class="wiki" href="http://www.tribler.org/trac/raw-attachment/wiki/SwarmBasedReputationConsensus/peers_richness_online_correlation_0806.png"><img src="http://www.tribler.org/trac/raw-attachment/wiki/SwarmBasedReputationConsensus/peers_richness_online_correlation_0806.png"></a>
</p>
<h3 id="Discoveryofpeersbycrawler">Discovery of peers by crawler</h3>
<p>
Crawler finds new permids in the system by via three ways. The are founded and given by Buddycast or they are in the from_id or to_id part of the bartercast record. If a peer given by Buddycast to the crawler, the crawler tries to connect to that peer and fetch some records from it. To evaluate how the system bhave in this case, the number of discovered permids in different cycle are counted. The first graph shows the cumulative number of discovered peers in different steps, with non-overlao between methods. For example if a permid was seen for the first time in the from_id part, it will not be counted in other ways. The second graph shows the same graph but with overlap. In this graph a permid may be counted in all three way. The last graph show daily discovery of new permids. As it is expected, at the beginning it finds many records but more or less it has decreasing trend.
</p>
<h3 id="Cumulativenumberofdiscoveredpeerswithoutoverlap">Cumulative number of discovered peers without overlap</h3>
<p>
<a class="wiki" href="http://www.tribler.org/trac/raw-attachment/wiki/SwarmBasedReputationConsensus/peers_stat_0806.png"><img src="http://www.tribler.org/trac/raw-attachment/wiki/SwarmBasedReputationConsensus/peers_stat_0806.png"></a>
</p>
<h3 id="Cumulativenumberofdiscoveredpeerswithoverlap">Cumulative number of discovered peers with overlap</h3>
<p>
<a class="wiki" href="http://www.tribler.org/trac/raw-attachment/wiki/SwarmBasedReputationConsensus/peers_stat_with_overlap_0806.png"><img src="http://www.tribler.org/trac/raw-attachment/wiki/SwarmBasedReputationConsensus/peers_stat_with_overlap_0806.png"></a>
</p>
<h3 id="dailydiscoveryofnewpeers">daily discovery of new peers</h3>
<p>
<a class="wiki" href="http://www.tribler.org/trac/raw-attachment/wiki/SwarmBasedReputationConsensus/peers_stat_newpeers_0806.png"><img src="http://www.tribler.org/trac/raw-attachment/wiki/SwarmBasedReputationConsensus/peers_stat_newpeers_0806.png"></a>
</p>
<h3 id="Cumulativenumberofconnectedpeers">Cumulative number of connected peers</h3>
<p>
<a class="wiki" href="http://www.tribler.org/trac/raw-attachment/wiki/SwarmBasedReputationConsensus/peers_stat_connected_peers_0806.png"><img src="http://www.tribler.org/trac/raw-attachment/wiki/SwarmBasedReputationConsensus/peers_stat_connected_peers_0806.png"></a>
</p>
<h3 id="Recordsupdatestatistics">Records update statistics</h3>
<p>
Another interesting that we measured was the update ratio of bartercast records. By update we mean, a record we same from_id and to_id but different downloaded or uploaded values. For example, record (A,B, d, u ) is an update of record (M,N, o , p ) if A=M and B=N and d&gt;=o or u &gt;= p. In the current system records are overwritten by new updated ones. We measured update ration of bartercast records in two case. First, by considering all records and second putting away those nodes that their from_id is equal to those to_id ( control records). usually control records seen a lot updates but real records very few. Figures below shows the histogram and also cumulative number of updates for these to set of records. Red color graph is for all records ( real and control records) and blue one for just for real records. <br />
</p>
<p>
Histogram for records with different updates (all records)<br />
<a class="wiki" href="http://www.tribler.org/trac/raw-attachment/wiki/SwarmBasedReputationConsensus/records_update_ratio_0806.png"><img src="http://www.tribler.org/trac/raw-attachment/wiki/SwarmBasedReputationConsensus/records_update_ratio_0806.png"></a>
</p>
<p>
Cumulative sum of records with different updates<br />
<a class="wiki" href="http://www.tribler.org/trac/raw-attachment/wiki/SwarmBasedReputationConsensus/records_update_ratio_cumulative_0806.png"><img src="http://www.tribler.org/trac/raw-attachment/wiki/SwarmBasedReputationConsensus/records_update_ratio_cumulative_0806.png"></a>
</p>
<p>
Histogram for records( distinct from_id and to_id ) with different number of updates<br />
<a class="wiki" href="http://www.tribler.org/trac/raw-attachment/wiki/SwarmBasedReputationConsensus/records_update_ratio_distinct_fromId_toId_0806.png"><img src="http://www.tribler.org/trac/raw-attachment/wiki/SwarmBasedReputationConsensus/records_update_ratio_distinct_fromId_toId_0806.png"></a>
</p>
<p>
Cumulative sum of records ( distinct from_id and to_id ) with different number of of updates<br />
<a class="wiki" href="http://www.tribler.org/trac/raw-attachment/wiki/SwarmBasedReputationConsensus/records_update_ratio_distinct_fromId_toId_cumulative_0806.png"><img src="http://www.tribler.org/trac/raw-attachment/wiki/SwarmBasedReputationConsensus/records_update_ratio_distinct_fromId_toId_cumulative_0806.png"></a>
</p>
<p>
As it is seen from the graph most of the records never get second update.<br /><br />
</p>
<h2 id="EvaluationofthemaxflowandBartercast">Evaluation of the maxflow and Bartercast</h2>
<p>
To answer the question of whether the Bartercast and maxflow are able to make a good estimation of peers' reputation or not, we calculated average of Subjective Reputations(SR) and then plotted it against net-contribution to Tribler peers. <br />
Because of some limitations in the way that crawler collects data, 50 records per each request, some of the collected local histories are not complete and this incompleteness may diverge the results accuracy. So before running the process we removed all of the incomplete local histories and their associated records. Comparison of these two record set is interesting:<br />
</p>
<ul><li>Number of records in whole set: 1,320,735 , Number of records in complete set: 986,235.  25% reduction <br />
</li><li>Number of local histories in whole set: 2,675 , Number of complete local histories: 1,425. 47% of local histories were incomplete  <br />
</li><li>Number of unique permids in whole set 9,442, Number of unique permids in just complete local histories: 9,396. 0.0049% reduction.<br />  <em>This means that complete local histories cover all records of incomplete caches.</em><br />
</li></ul><p>
We also separated the amount of upload/download between Triblers peers and all peers(Tribler and non-Tribler). Some facts about these values are::
</p>
<ul><li>Total Upload(MB) : 19,787,118, Total Download(MB): 18,361,551 , Total ratio: 1.078 , Total net-contribution (Upload - Download): 1,425,567, Number of peers in calculation: 7,717
</li><li><a class="missing" href="#">Upload/Download</a>(MB) between Tribler peers: 888,207 , Total Tribler ratio and contribution: 0, Number of peers in calculation is 2,635.
</li></ul><p>
For some nodes, 974 nodes,  we are able to calculate both total and Tribler contribution, the result is very interesting as well:<br />
</p>
<ul><li>Total upload(MB): 16,849,450, Total download(MB): 15,253,251 , Ratio=1.1
</li><li>Tribler Upload(MB): 470,851 , Total download(MB): 427,996 , Ratio=1.1
</li></ul><p>
But the interesting point is the ratio of Tribler upload and download to total upload and download. In both cases it is almost 0.03 and it means that <em>only 3% of data transfers happens between two Tribler peers and in 97% one side is non-Tribler.</em> It is not clear how much of this data is control data, like Buddycast or Bartercast messages?
</p>
<h3 id="CorrelationbetweenTriblernet-contributionandaverageofsubjectiveratios">Correlation between Tribler net-contribution and average of subjective ratios</h3>
<p>
The following graphs show the correlation between average of SRs and net-contribution. SRs are calculated from the view-point of the local history holder. For example, if peer Q be inside the local history of peer P( P is the holder of cache) then inside this cache, 2-hop maxflow is calculated from P to Q and from Q to P, then by using the formula: arctan(flow(Q-&gt;P) -flow(P-&gt;Q))/(PI/2) we calculate the reputation of Q from the point of view of P. Figures below show the average of these SRs, that were able to calculate SR:
</p>
<p>
Correlation graph without zooming
</p>
<blockquote>
<p>
<a class="wiki" href="http://www.tribler.org/trac/raw-attachment/wiki/SwarmBasedReputationConsensus/avg_2_hop_no_zoom.png"><img src="http://www.tribler.org/trac/raw-attachment/wiki/SwarmBasedReputationConsensus/avg_2_hop_no_zoom.png"></a>
</p>
</blockquote>
<p>
Correlation graph with [-1000 , 1000 ] on x-axis and [-0.2 ,0.2] on y-axis
</p>
<p>
<a class="wiki" href="http://www.tribler.org/trac/raw-attachment/wiki/SwarmBasedReputationConsensus/avg_2_hop_zoom_1000_2_2.png"><img src="http://www.tribler.org/trac/raw-attachment/wiki/SwarmBasedReputationConsensus/avg_2_hop_zoom_1000_2_2.png"></a>
</p>
<p>
Correlation graph with [-500,500] on x-axis and [-0.1, 0.1] on y-axis
</p>
<p>
<a class="wiki" href="http://www.tribler.org/trac/raw-attachment/wiki/SwarmBasedReputationConsensus/avg_2_hop_zoom_500_1_1.png"><img src="http://www.tribler.org/trac/raw-attachment/wiki/SwarmBasedReputationConsensus/avg_2_hop_zoom_500_1_1.png"></a>
</p>
<p>
Correlation graph with [-200,200] on x-axis and [-0.05 ,0.05] on y-axis
</p>
<p>
<a class="wiki" href="http://www.tribler.org/trac/raw-attachment/wiki/SwarmBasedReputationConsensus/avg_2_hop_zoom_200_05_05.png"><img src="http://www.tribler.org/trac/raw-attachment/wiki/SwarmBasedReputationConsensus/avg_2_hop_zoom_200_05_05.png"></a>
</p>
<p>
Correlation graph with [-100 , 100] on x-axis and [-0.2, 0.1] on y-axis
</p>
<p>
<a class="wiki" href="http://www.tribler.org/trac/raw-attachment/wiki/SwarmBasedReputationConsensus/avg_2_hop_zoom_100_2_1.png"><img src="http://www.tribler.org/trac/raw-attachment/wiki/SwarmBasedReputationConsensus/avg_2_hop_zoom_100_2_1.png"></a>
</p>
<p>
Correlation graph with [-100, 100] on x-axis and [-0.02, 0.02] on y-axis
</p>
<p>
<a class="wiki" href="http://www.tribler.org/trac/raw-attachment/wiki/SwarmBasedReputationConsensus/avg_2_hop_zoom_100_02_02.png"><img src="http://www.tribler.org/trac/raw-attachment/wiki/SwarmBasedReputationConsensus/avg_2_hop_zoom_100_02_02.png"></a>
</p>
<p>
As the graphs show there are few dots in the left-up and right-down quarters of the page and it means that there is positive correlation between Avg of SRs and net-contribution, but from the scattering of dots it does not seems to be a strong correlation. To give a better answer we calculated the correlation coefficient between these two parameters.Because of the non-linear function that is used in calculating the reputation, "arctan" , we don't expect to have a linear correlation between them, as Pearson correlation shows this fact. Before calculating we also removed outliers that may unexpectedly deviate the result. Below is the result for different models in 2-hop maxflow:<br />
</p>
<ul><li>Pearson:  coefficient: <strong>0.005,  significant level 0.813.</strong> Because significant level is much higher that 0.05, it means that there is no correlation between these two variables. 
</li><li>Kendall's tau_b: coefficient: <strong>0.308, significant level: 0.01</strong>, weak correlation.
</li><li>Spearman's rho: coefficient: <strong>0.415, significant level 0.01</strong>, average correlation.
</li></ul><p>
We also calculated the maxflow with 6-hop distance and below is the correlation coefficients:<br />
</p>
<ul><li>Pearson:  coefficient: <strong>0.009,  significant level 0.633.</strong> 
</li><li>Kendall's tau_b: coefficient: <strong>0.331, significant level: 0.01</strong>
</li><li>Spearman's rho: coefficient: <strong>0.448, significant level 0.01</strong>
</li></ul><p>
In comparison to 2-hop maxflow there is a little improvement but it is not spectacular.  
As it was expected there is no strong correlation two parameters but at least it is positive and we can conclude that Bartercast and maxflow can differentiate between very bad and very good users, but not more.  
<br /><br />  
</p>
<h3 id="researchproblems">research problems</h3>
<ul><li>decide for a peer: altruist, freeriding, nautral, newcomer.
</li><li>informativeness
</li><li>dissemination (perfect gossip assumption)
</li><li>best informed policy
</li><li>would work for other/any policy?
</li><li>what accuracy does policy X need?
</li></ul><p>
 
</p>
<h2 id="RelatedworkAlternativeapproaches:">Related work / Alternative approaches:</h2>
<ul><li><a class="ext-link" href="http://www.cs.washington.edu/homes/piatek/papers/onehop_nsdi08.pdf"><span class="icon">​</span>One Hop Reputation for P2P systems</a>: a reputation mechanism for <a class="wiki" href="/BitTorrent">BitTorrent</a> where trusted peers serve as credit repositories for other peers. A contributes to B and B tells a trusted peer T. When A wants service from C, it asks T to tell C that C is going to earn A's credits currently stored in T. 
</li><li><a class="ext-link" href="http://www.ee.ucl.ac.uk/~rlanda/infocom09.pdf"><span class="icon">​</span>A Sybilproof Indirect Reciprocity Mechanism for Peer-to-Peer Networks</a>: Models the contribution problem as a routing one. Sybil-proof, but does not seem to take churn into account. 
</li></ul><ul><li>[<a class="ext-link" href="http://www.cs.vu.nl/~steen/papers/2009.icdcn.pdf"><span class="icon">​</span>http://www.cs.vu.nl/~steen/papers/2009.icdcn.pdf</a>:  This paper does a probabilistic analysis for dissemination of information in a network of nodes that run Shuffle gossip protocol. They analyze the speed  of dissemination and coverage. For real cases it seems to be unusable , because there is no notion of churn and information lost. The action in the protocol are also atomic which is unrealistic. 
</li><li><a class="ext-link" href="http://www.nature.com/nature/journal/v437/n7063/full/nature04131.html"><span class="icon">​</span>Evolution of indirect reciprocity</a>, Nature Journal.
</li><li><a class="ext-link" href="http://www.nature.com/nature/journal/v364/n6432/abs/364056a0.html"><span class="icon">​</span>A strategy of win-stay, lose-shift that outperforms tit-for-tat in the Prisoner's Dilemma game</a>, Nature Journal
</li><li><a class="ext-link" href="http://webee.technion.ac.il/~idish/ftp/Brahms-Comnet-Mar09.pdf"><span class="icon">​</span>Brahms: Byzantine Resilient Random Membership Sampling</a>
</li></ul></td>
</tr>
</table>
</section>	

</body>
</html>